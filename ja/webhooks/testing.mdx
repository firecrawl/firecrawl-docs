---
title: 'テストとデバッグ'
description: 'Webhook の開発・デバッグのためのツールと手法'
og:title: 'Webhook のテストとデバッグ | Firecrawl'
og:description: 'Webhook の開発・デバッグのためのツールと手法'
icon: 'bug'
---

このページでは、開発中の webhook 連携のテストや、本番環境での問題のデバッグに役立つツールと手法を解説します。

<div id="local-development">
  ## ローカル開発
</div>

<div id="exposing-local-servers">
  ### ローカルサーバーの公開
</div>

Webhook はインターネット経由であなたのサーバーに到達する必要があるため、ローカルの開発サーバーを公開する必要があります。

<div id="using-cloudflare-tunnels">
  #### Cloudflare Tunnels の利用
</div>

[Cloudflare Tunnels](https://github.com/cloudflare/cloudflared/releases) は、アカウント登録やファイアウォールのポート開放なしで、ローカル開発サーバーを安全にインターネットへ公開できる無料の方法です。

```bash
# GitHubのリリースからcloudflaredをダウンロードするか、パッケージマネージャーを利用します

# ローカルサーバーを公開する
cloudflared tunnel --url localhost:3000

# 出力例:
# クイックトンネルが作成されました！次のURLにアクセスしてください（到達可能になるまで時間がかかる場合があります）:
# https://abc123.trycloudflare.com
```

Webhook の設定で、提供された URL を使用してください：

```json
{
  "url": "https://abc123.trycloudflare.com/webhook"
}
```


<div id="debugging-common-issues">
  ## よくある問題のデバッグ
</div>

<div id="webhooks-not-arriving">
  ### Webhook が届かない
</div>

1. **URL の到達性を確認** – エンドポイントが外部からアクセス可能であることを確認する
2. **HTTPS を確認** – Webhook の URL は必ず HTTPS を使用する
3. **ファイアウォール設定を確認** – Webhook 用ポートへの受信接続を許可する
4. **イベントフィルターを確認** – 対象のイベントタイプを購読していることを確認する

<div id="signature-verification-failing">
  ### 署名検証が失敗する
</div>

1. **シークレットキーを確認** – 正しいシークレットを使用していることを確認してください

2. **生のボディを使用しているか確認** – 生のリクエストボディを使用していることを確認してください：

```javascript
// ❌ 誤り - 解析後のボディを使用している
const signature = crypto
  .createHmac('sha256', secret)
  .update(JSON.stringify(req.body))
  .digest('hex');

// ✅ 正解 - 生のボディを使用する
app.use('/webhook', express.raw({ type: 'application/json' }));
app.post('/webhook', (req, res) => {
  const signature = crypto
    .createHmac('sha256', secret)
    .update(req.body) // 生のバッファ
    .digest('hex');
});
```
