---
title: 'Rastreio de mudanças'
description: 'O Firecrawl pode rastrear alterações entre a página atual e uma versão anterior e informar se ela foi atualizada ou não'
og:title: "Rastreio de mudanças | Firecrawl"
sidebarTitle: "Rastreio de mudanças"
og:description: "O Firecrawl pode rastrear alterações entre a página atual e uma versão anterior e informar se ela foi atualizada ou não"
---

![Rastreio de mudanças](/images/launch-week/lw3d12.webp)

O rastreio de mudanças permite monitorar e detectar alterações em conteúdos da web ao longo do tempo. Este recurso está disponível nos SDKs de JavaScript e Python.

<div id="overview">
  ## Visão geral
</div>

O rastreio de mudanças permite que você:

- Detecte se uma página da web mudou desde a última coleta
- Veja as mudanças específicas entre coletas
- Obtenha dados estruturados sobre o que mudou
- Controle a visibilidade das mudanças

Usando o formato `changeTracking`, você pode monitorar mudanças em um site e receber informações sobre:

- `previousScrapeAt`: O carimbo de data/hora da coleta anterior contra a qual a página atual está sendo comparada (`null` se não houve coleta anterior)
- `changeStatus`: O resultado da comparação entre as duas versões da página
  - `new`: Esta página não existia ou não havia sido descoberta antes (geralmente tem `previousScrapeAt` como `null`)
  - `same`: O conteúdo desta página não mudou desde a última coleta
  - `changed`: O conteúdo desta página mudou desde a última coleta
  - `removed`: Esta página foi removida desde a última coleta
- `visibility`: A visibilidade da página/URL atual
  - `visible`: Esta página está visível, ou seja, sua URL foi descoberta por uma rota orgânica (por meio de links em outras páginas visíveis ou do sitemap)
  - `hidden`: Esta página não está visível, ou seja, ainda está disponível na web, mas não é mais descobrível pelo sitemap ou ao rastrear o site. Só podemos identificar links invisíveis se eles já tiverem sido visíveis e capturados durante um rastreio ou coleta anteriores

<div id="javascript-sdk">
  ## SDK JavaScript
</div>

<div id="basic-usage">
  ### Uso básico
</div>

Para usar o rastreioDeMudanças no SDK JavaScript, inclua `'changeTracking'` no array de formatos ao fazer o scraping de uma URL:

```javascript
const app = new FirecrawlApp({ apiKey: 'sua-api-key' });
const result = await app.scrapeUrl('https://example.com', {
  formats: ['markdown', 'changeTracking']
});

// Acessar dados de rastreio de mudanças
console.log(result.changeTracking.changeStatus); // 'novo', 'igual', 'alterado' ou 'removido'
console.log(result.changeTracking.visibility); // 'visível' ou 'oculto'
console.log(result.changeTracking.previousScrapeAt); // timestamp ISO da raspagem anterior
```

Exemplo de resposta:

```json
{
  "url": "https://firecrawl.dev",
  "markdown": "# Agentes de IA para excelentes experiências do cliente\n\nChatbots que encantam seus usuários...",
  "changeTracking": {
    "previousScrapeAt": "2025-04-10T12:00:00Z",
    "changeStatus": "changed",
    "visibility": "visible"
  }
}
```


<div id="advanced-options">
  ### Opções avançadas
</div>

Você pode configurar o rastreio de mudanças com opções adicionais:

```javascript
const result = await app.scrapeUrl('https://example.com', {
  formats: ['markdown', 'changeTracking'],
  changeTrackingOptions: {
    modes: ['git-diff', 'json'], // Ativa modos específicos de rastreioDeMudanças
    schema: { 
      type: 'object', 
      properties: { 
        title: { type: 'string' },
        content: { type: 'string' }
      } 
    }, // Esquema para comparação JSON estruturada
    prompt: 'Prompt personalizado para extração', // Prompt opcional personalizado
    tag: 'produção' // Tag opcional para manter históricos de rastreamento separados
  }
});

// Acessar alterações no formato git-diff
if (result.changeTracking.diff) {
  console.log(result.changeTracking.diff.text); // Diff em texto no estilo Git
  console.log(result.changeTracking.diff.json); // Diff estruturado em JSON
}

// Acessar alterações na comparação JSON
if (result.changeTracking.json) {
  console.log(result.changeTracking.json.title.previous); // Título anterior
  console.log(result.changeTracking.json.title.current); // Título atual
}
```


<div id="git-diff-results-example">
  ### Exemplo de resultados de Git diff:
</div>

```
 **13 de abril de 2025**
 
-**17:55:05**
+**17:58:57**

...
```


<div id="json-comparison-results-example">
  ### Exemplo de resultados de comparação em JSON:
</div>

```json
{
  "time": { 
    "previous": "2025-04-13T17:54:32Z", 
    "current": "2025-04-13T17:55:05Z" 
  }
}
```


<div id="typescript-interface">
  ### Interface em TypeScript
</div>

O recurso de rastreio de mudanças inclui as seguintes interfaces de TypeScript:

```typescript
interface FirecrawlDocument {
  // ... outras propriedades
  changeTracking?: {
    previousScrapeAt: string | null;
    changeStatus: "new" | "same" | "changed" | "removed";
    visibility: "visible" | "hidden";
    diff?: {
      text: string;
      json: {
        files: Array<{
          from: string | null;
          to: string | null;
          chunks: Array<{
            content: string;
            changes: Array<{
              type: string;
              normal?: boolean;
              ln?: number;
              ln1?: number;
              ln2?: number;
              content: string;
            }>;
          }>;
        }>;
      };
    };
    json?: any;
  };
}

interface ScrapeParams {
  // ... outras propriedades
  changeTrackingOptions?: {
    prompt?: string;
    schema?: any;
    modes?: ("json" | "git-diff")[];
    tag?: string | null;
  }
}
```


<div id="python-sdk">
  ## SDK do Python
</div>

<div id="basic-usage">
  ### Uso básico
</div>

Para usar o rastreioDeMudanças no SDK Python, inclua &#39;changeTracking&#39; na lista de formatos ao extrair dados de uma URL:

```python
from firecrawl import FirecrawlApp, ChangeTrackingOptions

app = FirecrawlApp(api_key='your-api-key')
result = app.scrape_url('https://example.com',
    formats=['markdown', 'changeTracking']
)

# Access change tracking data
print("Status da mudança:", result.changeTracking.changeStatus)  # 'novo', 'igual', 'alterado' ou 'removido'
print("Visibilidade:", result.changeTracking.visibility)  # 'visível' ou 'oculto'
print("Data da raspagem anterior:", result.changeTracking.previousScrapeAt)  # carimbo de data/hora ISO da raspagem anterior
```


<div id="advanced-options">
  ### Opções avançadas
</div>

Você pode configurar o rastreio de mudanças com opções adicionais:

```python
result = app.scrape_url('https://example.com',
    formats=['markdown', 'changeTracking'],
    change_tracking_options=ChangeTrackingOptions(
        modes=['git-diff', 'json'],  # Habilita modos específicos de rastreio de mudanças
        schema={
            'type': 'object',
            'properties': {
                'title': {'type': 'string'},
                'content': {'type': 'string'}
            }
        },  # Esquema para comparação de JSON estruturado
        prompt='Prompt personalizado para extração',  # Prompt opcional
        tag='production'  # Tag opcional para manter históricos de rastreio de mudanças separados
    )
)

# Acessar mudanças no formato git-diff
if 'diff' in result.changeTracking:
    print(result.changeTracking.diff.text)  # Texto de diff no estilo Git
    print(result.changeTracking.diff.json)  # Dados de diff estruturados

# Acessar mudanças na comparação em JSON
if 'json' in result.changeTracking:
    print(result.changeTracking.json.title.previous)  # Título anterior
    print(result.changeTracking.json.title.current)  # Título atual
```


<div id="python-data-model">
  ### Modelo de dados em Python
</div>

O recurso de rastreio de mudanças inclui o seguinte modelo de dados em Python:

```python
class ChangeTrackingData(pydantic.BaseModel):
    """
    Dados para o formato de rastreio de mudanças.
    """
    previousScrapeAt: Optional[str] = None
    changeStatus: str  # "novo" | "inalterado" | "alterado" | "removido"
    visibility: str  # "visível" | "oculta"
    diff: Optional[Dict[str, Any]] = None
    json: Optional[Any] = None
```


<div id="change-tracking-modes">
  ## Modos de Rastreio de Mudanças
</div>

O recurso de rastreio de mudanças oferece suporte a dois modos:

<div id="git-diff-mode">
  ### Modo Git-Diff
</div>

O modo `git-diff` fornece um formato de diff tradicional, semelhante à saída do Git. Ele mostra alterações linha a linha, com adições e remoções destacadas.

Exemplo de saída:

```
@@ -1,1 +1,1 @@
-conteúdo antigo
+novo conteúdo
```

A representação JSON estruturada do diff inclui:

* `files`: Lista de arquivos alterados (no contexto da web, normalmente apenas um)
* `chunks`: Seções de alterações dentro de um arquivo
* `changes`: Mudanças individuais de linha com tipo (add, delete, normal)


<div id="json-mode">
  ### Modo JSON
</div>

O modo `json` fornece uma comparação estruturada de campos específicos extraídos do conteúdo. Isso é útil para acompanhar alterações em pontos de dados específicos, em vez de em todo o conteúdo.

Exemplo de saída:

```json
{
  "title": {
    "previous": "Título anterior",
    "current": "Título novo",
  },
  "price": {
    "previous": "US$ 19,99",
    "current": "US$ 24,99"
  }
}
```

Para usar o modo JSON, você precisa fornecer um esquema que defina os campos a serem extraídos e comparados.


<div id="important-facts">
  ## Fatos importantes
</div>

Aqui estão alguns pontos importantes ao usar o recurso de rastreioDeMudanças:

- **Método de comparação**: As coletas (scrapes) são sempre comparadas pela resposta em markdown.
  - O formato `markdown` também deve ser especificado ao usar o formato `rastreioDeMudanças`. Outros formatos podem ser especificados adicionalmente.
  - O algoritmo de comparação é resistente a mudanças em espaços em branco e na ordem do conteúdo. URLs de origem de iframes são atualmente ignoradas para resistir a captchas e antibots com URLs aleatórias.

- **Correspondência com coletas anteriores**: As coletas anteriores usadas para comparação são atualmente correspondidas pela URL de origem, pelo ID da equipe, pelo formato `markdown` e pelo parâmetro `tag`.
  - Para uma comparação eficaz, a URL de entrada deve ser exatamente a mesma da solicitação anterior para o mesmo conteúdo.
  - Rastear as mesmas URLs com `includePaths`/`excludePaths` diferentes pode gerar inconsistências ao usar `rastreioDeMudanças`.
  - Fazer scrape das mesmas URLs com `includeTags`/`excludeTags`/`onlyMainContent` diferentes pode gerar inconsistências ao usar `rastreioDeMudanças`.
  - As páginas também serão comparadas com coletas anteriores que tenham apenas o formato `markdown`, sem o formato `rastreioDeMudanças`.
  - As comparações são restritas à sua equipe. Se você fizer o scrape de uma URL pela primeira vez com sua chave de API, o `changeStatus` será sempre `new`, mesmo que outros usuários do Firecrawl já a tenham coletado antes.

- **Status Beta**: Enquanto estiver em Beta, recomenda-se monitorar o campo `warning` do documento resultante e tratar a possível ausência do objeto `rastreioDeMudanças` na resposta.
  - Isso pode ocorrer quando a busca no banco de dados pelo scrape anterior para comparação excede o tempo limite.

<div id="examples">
  ## Exemplos
</div>

<div id="basic-scrape-example">
  ### Exemplo básico de scraping
</div>

```json
// Solicitação
{
    "url": "https://firecrawl.dev",
    "formats": ["markdown", "changeTracking"]
}

// Resposta
{
  "success": true,
  "data": {
    "markdown": "...",
    "metadata": {...},
    "changeTracking": {
      "previousScrapeAt": "2025-03-30T15:07:17.543071+00:00",
      "changeStatus": "same",
      "visibility": "visible"
    }
  }
}
```


<div id="crawl-example">
  ### Exemplo de Crawler
</div>

```json
// Solicitação
{
    "url": "https://firecrawl.dev",
    "scrapeOptions": {
        "formats": ["markdown", "changeTracking"]
    }
}
```


<div id="tracking-product-price-changes">
  ### Acompanhando mudanças de preço de produtos
</div>

```javascript
// JavaScript
const result = await app.scrapeUrl('https://example.com/product', {
  formatos: ['markdown', 'rastreioDeMudanças'],
  changeTrackingOptions: {
    modes: ['json'],
    schema: {
      type: 'object',
      properties: {
        price: { type: 'string' },
        availability: { type: 'string' }
      }
    }
  }
});

if (result.changeTracking.changeStatus === 'changed') {
  console.log(`O preço mudou de ${result.changeTracking.json.price.previous} para ${result.changeTracking.json.price.current}`);
}
```

```python
# Python
result = app.scrape_url('https://example.com/product',
    formats=['markdown', 'changeTracking'],
    changeTrackingOptions={
        'modes': ['json'],
        'schema': {
            'type': 'object',
            'properties': {
                'price': {'type': 'string'},
                'availability': {'type': 'string'}
            }
        }
    }
)

if result.changeTracking.changeStatus == 'changed':
    print(f"Preço mudou de {result.changeTracking.json.price.previous} para {result.changeTracking.json.price.current}")
```


<div id="monitoring-content-changes-with-git-diff">
  ### Monitoramento de alterações de conteúdo com git-diff
</div>

```javascript
// JavaScript
const result = await app.scrapeUrl('https://example.com/blog', {
  formatos: ['markdown', 'rastreioDeMudanças'],
  changeTrackingOptions: {
    modes: ['git-diff']
  }
});

if (result.changeTracking.changeStatus === 'changed') {
  console.log('Alterações no conteúdo:');
  console.log(result.changeTracking.diff.text);
}
```

```python
# Python
result = app.scrape_url('https://example.com/blog',
    formats=['markdown', 'changeTracking'],
    changeTrackingOptions={
        'modes': ['git-diff']
    }
)

if result.changeTracking.changeStatus == 'changed':
    print('Alterações no conteúdo:')
    print(result.changeTracking.diff.text)
```


<div id="billing">
  ## Cobrança
</div>

O recurso de rastreioDeMudanças está em beta. Usar a funcionalidade básica de rastreioDeMudanças e o modo `git-diff` não tem custo adicional. Porém, se você usar o modo `json` para comparação de dados estruturados, a raspagem da página custará 5 créditos por página.